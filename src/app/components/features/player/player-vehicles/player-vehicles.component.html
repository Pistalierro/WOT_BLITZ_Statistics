<ng-container>
  <mat-form-field>
    <mat-label>Используйте фильтр для поиска техники здесь...</mat-label>
    <input #input
           (keyup)="applyFilter($event)"
           class="filter"
           matInput
           placeholder="Например: 'Объект 907' или 'WZ-120-1G FT'"
    />
  </mat-form-field>

  <div class="mat-elevation-z8">
    <div class="table-responsive">
      <table [dataSource]="dataSource" mat-table matSort>

        <ng-container matColumnDef="name">
          <th *matHeaderCellDef mat-header-cell mat-sort-header> Название</th>
          <td *matCellDef="let row" mat-cell> {{ row.name }}</td>
        </ng-container>

        <ng-container matColumnDef="winRate">
          <th *matHeaderCellDef mat-header-cell mat-sort-header> Процент побед</th>
          <td *matCellDef="let row" mat-cell>
            {{ getWinRate(row) | number:'1.2-2' }}%
          </td>
        </ng-container>

        <ng-container matColumnDef="damageDeal">
          <th *matHeaderCellDef mat-header-cell mat-sort-header> Средний урон</th>
          <td *matCellDef="let row" mat-cell>
            <!-- Вызываем метод getDamageDeal, форматируем через пайп -->
            {{ getDamageDeal(row) | number:'1.0-0' }}
          </td>
        </ng-container>

        <ng-container matColumnDef="nation">
          <th *matHeaderCellDef mat-header-cell mat-sort-header> Нация</th>
          <td *matCellDef="let row" mat-cell> {{ row.nation }}</td>
        </ng-container>

        <ng-container matColumnDef="battles">
          <th *matHeaderCellDef mat-header-cell mat-sort-header> Всего боёв</th>
          <td *matCellDef="let row" mat-cell>
            {{ row.all.battles }}
          </td>
        </ng-container>

        <ng-container matColumnDef="wins">
          <th *matHeaderCellDef mat-header-cell mat-sort-header> Победы</th>
          <td *matCellDef="let row" mat-cell>
            {{ row.all.wins }}
          </td>
        </ng-container>

        <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
        <tr *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
        <tr *matNoDataRow class="mat-row">
          <td class="mat-cell" colspan="7">
            <ng-container *ngIf="!vehicleService.errorSignal(); else error">
              No data matching the filter "{{ input.value }}"
            </ng-container>
            <ng-template #error>
              <p class="error">Ошибка: {{ vehicleService.errorSignal() }}</p>
            </ng-template>
          </td>
        </tr>
      </table>
    </div>

    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10" aria-label="Select page of users"></mat-paginator>
  </div>
</ng-container>

<div *ngIf="vehicleService.loadingSignal()" class="loading">
  <p>Загрузка данных...</p>
</div>


